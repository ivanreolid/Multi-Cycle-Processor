The purpose of this file is to explain implementation decisions that have been taken and possible problems that are going to appear.

1. Stalls

The main idea is to always try to free decode from being stalled in order to issue instructions to both ALU and EX stages.

Example1:
  1. Memory stage stalled and another memory instruction in decode stage
  2. Let the new memory operation to be issued to the ALU stage even if it is going to get stalled.
  3. With that, we let a potential multiplication to be issued.

Example2:
  1. Memory stage stalled and an ALU instruction in decode stage
  2. Let the ALU instruction to be issued.
  3. With that, the ALU instruction is able to complete out of order and we allow either another ALU instruction to be issued or a multiplication instruction.

2. Completions, commits and write backs

WB arbiter is the responsible to select which stage is able to complete. The priority is: MEM > EX5 > ALU.
When an instruction is not granted to complete, it has to remain at its stage.
When an instruction is granted to complete:
  1. The destination register in the future file is written at the end of the cycle (if it is a wb instruction).
  2. The instruction is marked as completed in the reorder buffer next cycle.
When an instruction in the reorder buffer is marked as completed and is the head of it:
  1. The destination register in the architectural file is written at the end of the cycle (if it is a wb instruction).
  2. It is marked as committed (visible for the testbench) next cycle.

Performance results

No caches

Buffer sum
  - Total cycles = 24360
  - Instructions executed = 1677
  - CPI = 14.535

Mem copy
  - Total cycles = 25757
  - Instructions executed = 1804
  - CPI = 14.286

Matrix multiply
  This test is really huge that it takes to much time to simulate (at least with modelsim). The total number of cycles is not accurate since it has been calculated from having the total number of cycles executed for 9 iterations of the loop i and then extrapolated to the 128 iterations for i.
  - Total cycles = 373.450.536
  - Instructions executed = 29.689.746
  - CPI = 12.58
